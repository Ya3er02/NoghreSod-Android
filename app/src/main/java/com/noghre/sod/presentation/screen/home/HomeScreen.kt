package com.noghre.sod.presentation.screen.home\n\nimport androidx.compose.foundation.layout.*\nimport androidx.compose.foundation.lazy.LazyColumn\nimport androidx.compose.foundation.lazy.items\nimport androidx.compose.material.icons.Icons\nimport androidx.compose.material.icons.filled.Search\nimport androidx.compose.material.icons.filled.ShoppingCart\nimport androidx.compose.material3.*\nimport androidx.compose.runtime.*\nimport androidx.compose.ui.Alignment\nimport androidx.compose.ui.Modifier\nimport androidx.compose.ui.unit.dp\nimport androidx.hilt.navigation.compose.hiltViewModel\nimport com.noghre.sod.domain.model.ProductSummary\nimport com.noghre.sod.presentation.components.LoadingIndicator\nimport com.noghre.sod.presentation.components.ErrorDisplay\n\n/**\n * Home screen displaying featured products and categories.\n *\n * @param onProductClick Callback when a product is clicked\n * @param onCategoryClick Callback when a category is clicked\n * @param onSearchClick Callback for search navigation\n * @param onCartClick Callback for cart navigation\n * @param viewModel HomeViewModel for state management\n */\n@Composable\nfun HomeScreen(\n    onProductClick: (String) -> Unit,\n    onCategoryClick: (String) -> Unit,\n    onSearchClick: () -> Unit,\n    onCartClick: () -> Unit,\n    viewModel: HomeViewModel = hiltViewModel()\n) {\n    val uiState by viewModel.uiState.collectAsState()\n\n    Scaffold(\n        topBar = {\n            HomeTopBar(\n                onSearchClick = onSearchClick,\n                onCartClick = onCartClick\n            )\n        }\n    ) { paddingValues ->\n        when (val state = uiState) {\n            is HomeUiState.Loading -> {\n                LoadingIndicator(\n                    modifier = Modifier.padding(paddingValues),\n                    message = \"محصوالت در حال بارگذاری\"\n                )\n            }\n            is HomeUiState.Success -> {\n                HomeContent(\n                    modifier = Modifier.padding(paddingValues),\n                    featuredProducts = state.featuredProducts,\n                    categories = state.categories,\n                    onProductClick = onProductClick,\n                    onCategoryClick = onCategoryClick\n                )\n            }\n            is HomeUiState.Error -> {\n                ErrorDisplay(\n                    modifier = Modifier.padding(paddingValues),\n                    message = state.message,\n                    onRetry = viewModel::loadData\n                )\n            }\n        }\n    }\n}\n\n@OptIn(ExperimentalMaterial3Api::class)\n@Composable\nprivate fun HomeTopBar(\n    onSearchClick: () -> Unit,\n    onCartClick: () -> Unit\n) {\n    TopAppBar(\n        title = {\n            Text(text = \"نقره‌سد\", style = MaterialTheme.typography.headlineMedium)\n        },\n        actions = {\n            IconButton(onClick = onSearchClick) {\n                Icon(\n                    imageVector = Icons.Default.Search,\n                    contentDescription = \"جستجو\"\n                )\n            }\n            IconButton(onClick = onCartClick) {\n                Icon(\n                    imageVector = Icons.Default.ShoppingCart,\n                    contentDescription = \"سبد خرید\"\n                )\n            }\n        },\n        colors = TopAppBarDefaults.topAppBarColors(\n            containerColor = MaterialTheme.colorScheme.primary,\n            titleContentColor = MaterialTheme.colorScheme.onPrimary,\n            actionIconContentColor = MaterialTheme.colorScheme.onPrimary\n        )\n    )\n}\n\n@Composable\nprivate fun HomeContent(\n    modifier: Modifier = Modifier,\n    featuredProducts: List<ProductSummary>,\n    categories: List<String>,\n    onProductClick: (String) -> Unit,\n    onCategoryClick: (String) -> Unit\n) {\n    LazyColumn(\n        modifier = modifier.fillMaxSize(),\n        contentPadding = PaddingValues(16.dp),\n        verticalArrangement = Arrangement.spacedBy(16.dp)\n    ) {\n        // Categories section\n        item {\n            Text(\n                text = \"دسته‌بندی‌ها\",\n                style = MaterialTheme.typography.titleLarge\n            )\n        }\n        item {\n            CategoriesGrid(\n                categories = categories,\n                onCategoryClick = onCategoryClick\n            )\n        }\n        // Featured products section\n        item {\n            Text(\n                text = \"محصوالت ویژه\",\n                style = MaterialTheme.typography.titleLarge\n            )\n        }\n        items(featuredProducts) { product ->\n            ProductCard(\n                product = product,\n                onClick = { onProductClick(product.id) }\n            )\n        }\n    }\n}\n\n@Composable\nprivate fun CategoriesGrid(\n    categories: List<String>,\n    onCategoryClick: (String) -> Unit,\n    modifier: Modifier = Modifier\n) {\n    Column(modifier = modifier.fillMaxWidth()) {\n        categories.forEach { category ->\n            Button(\n                onClick = { onCategoryClick(category) },\n                modifier = Modifier\n                    .fillMaxWidth()\n                    .padding(vertical = 8.dp),\n                colors = ButtonDefaults.outlinedButtonColors()\n            ) {\n                Text(text = category)\n            }\n        }\n    }\n}\n\n@Composable\nprivate fun ProductCard(\n    product: ProductSummary,\n    onClick: () -> Unit,\n    modifier: Modifier = Modifier\n) {\n    Card(\n        modifier = modifier\n            .fillMaxWidth(),\n        onClick = onClick\n    ) {\n        Column(modifier = Modifier.padding(16.dp)) {\n            Text(\n                text = product.name,\n                style = MaterialTheme.typography.titleMedium\n            )\n            Spacer(modifier = Modifier.height(8.dp))\n            Text(\n                text = product.price.formatted(),\n                style = MaterialTheme.typography.bodyLarge,\n                color = MaterialTheme.colorScheme.primary\n            )\n            if (product.isNew) {\n                Spacer(modifier = Modifier.height(8.dp))\n                Text(\n                    text = \"جدید\",\n                    style = MaterialTheme.typography.labelSmall,\n                    color = MaterialTheme.colorScheme.secondary\n                )\n            }\n        }\n    }\n}\n\n// ============== UI STATE ==============\n\n/**\n * UI state for Home Screen.\n */\nsealed class HomeUiState {\n    object Loading : HomeUiState()\n    data class Success(\n        val featuredProducts: List<ProductSummary>,\n        val categories: List<String>\n    ) : HomeUiState()\n    data class Error(val message: String) : HomeUiState()\n}\n